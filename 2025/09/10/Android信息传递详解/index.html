
<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="utf-8" />
    <title>Android信息传递详解 | NaoJianghh</title>
    <meta name="author" content="脑浆糊" />
    <meta name="description" content="Welcome to My Blog" />
    <meta name="keywords" content="学习" />
    <meta
        name="viewport"
        content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0"
    />
    <link rel="icon" href="/images/avatar.jpg" />
    <link rel="preconnect" href="https://s4.zstatic.net" />
<script src="https://s4.zstatic.net/ajax/libs/vue/3.3.7/vue.global.prod.min.js"></script>
<link rel="stylesheet" href="https://s4.zstatic.net/ajax/libs/font-awesome/6.4.2/css/all.min.css" />
<link rel="preconnect" href="https://fonts.googleapis.cn" />
<link rel="preconnect" href="https://fonts.gstatic.cn" crossorigin />
<link
    rel="stylesheet"
    href="https://fonts.googleapis.cn/css2?family=Fira+Code:wght@400;500;600;700&family=Lexend:wght@400;500;600;700;800;900&family=Noto+Sans+SC:wght@400;500;600;700;800;900&display=swap"
/>
<script> const mixins = {}; </script>

<script src="https://polyfill.alicdn.com/v3/polyfill.min.js?features=default"></script>


<script src="https://s4.zstatic.net/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
<script src="https://s4.zstatic.net/ajax/libs/highlightjs-line-numbers.js/2.8.0/highlightjs-line-numbers.min.js"></script>
<link
    rel="stylesheet"
    href="https://s4.zstatic.net/ajax/libs/highlight.js/11.9.0/styles/github.min.css"
/>
<script src="/js/lib/highlight.js"></script>



<script src="/js/lib/preview.js"></script>









<link rel="stylesheet" href="/css/main.css" />

<meta name="generator" content="Hexo 7.3.0"><link rel="alternate" href="/atom.xml" title="NaoJianghh" type="application/atom+xml">
</head>
<body>
    <div id="layout">
        <transition name="fade">
            <div id="loading" v-show="loading">
                <div id="loading-circle">
                    <h2>LOADING</h2>
                    <p>加载过慢请开启缓存 浏览器默认开启</p>
                    <img src="/images/loading.gif" />
                </div>
            </div>
        </transition>
        <div id="menu" :class="{ hidden: hiddenMenu, 'menu-color': menuColor}">
    <nav id="desktop-menu">
        <a class="title" href="/">
            <span>NAOJIANGHH</span>
        </a>
        
        <a href="/">
            <i class="fa-solid fa-house fa-fw"></i>
            <span>&ensp;Home</span>
        </a>
        
        <a href="/about">
            <i class="fa-solid fa-id-card fa-fw"></i>
            <span>&ensp;About</span>
        </a>
        
        <a href="/archives">
            <i class="fa-solid fa-box-archive fa-fw"></i>
            <span>&ensp;Archives</span>
        </a>
        
        <a href="/categories">
            <i class="fa-solid fa-bookmark fa-fw"></i>
            <span>&ensp;Categories</span>
        </a>
        
        <a href="/tags">
            <i class="fa-solid fa-tags fa-fw"></i>
            <span>&ensp;Tags</span>
        </a>
        
    </nav>
    <nav id="mobile-menu">
        <div class="title" @click="showMenuItems = !showMenuItems">
            <i class="fa-solid fa-bars fa-fw"></i>
            <span>&emsp;NAOJIANGHH</span>
        </div>
        <transition name="slide">
            <div class="items" v-show="showMenuItems">
                
                <a href="/">
                    <div class="item">
                        <div style="min-width: 20px; max-width: 50px; width: 10%">
                            <i class="fa-solid fa-house fa-fw"></i>
                        </div>
                        <div style="min-width: 100px; max-width: 150%; width: 20%">Home</div>
                    </div>
                </a>
                
                <a href="/about">
                    <div class="item">
                        <div style="min-width: 20px; max-width: 50px; width: 10%">
                            <i class="fa-solid fa-id-card fa-fw"></i>
                        </div>
                        <div style="min-width: 100px; max-width: 150%; width: 20%">About</div>
                    </div>
                </a>
                
                <a href="/archives">
                    <div class="item">
                        <div style="min-width: 20px; max-width: 50px; width: 10%">
                            <i class="fa-solid fa-box-archive fa-fw"></i>
                        </div>
                        <div style="min-width: 100px; max-width: 150%; width: 20%">Archives</div>
                    </div>
                </a>
                
                <a href="/categories">
                    <div class="item">
                        <div style="min-width: 20px; max-width: 50px; width: 10%">
                            <i class="fa-solid fa-bookmark fa-fw"></i>
                        </div>
                        <div style="min-width: 100px; max-width: 150%; width: 20%">Categories</div>
                    </div>
                </a>
                
                <a href="/tags">
                    <div class="item">
                        <div style="min-width: 20px; max-width: 50px; width: 10%">
                            <i class="fa-solid fa-tags fa-fw"></i>
                        </div>
                        <div style="min-width: 100px; max-width: 150%; width: 20%">Tags</div>
                    </div>
                </a>
                
            </div>
        </transition>
    </nav>
</div>
<transition name="fade">
    <div id="menu-curtain" @click="showMenuItems = !showMenuItems" v-show="showMenuItems"></div>
</transition>

        <div id="main" :class="loading ? 'into-enter-from': 'into-enter-active'">
            <div class="article">
    <div>
        <h1>Android信息传递详解</h1>
    </div>
    <div class="info">
        <span class="date">
            <span class="icon">
                <i class="fa-solid fa-calendar fa-fw"></i>
            </span>
            2025/9/10
        </span>
        
        
        <span class="tags">
            <span class="icon">
                <i class="fa-solid fa-tags fa-fw"></i>
            </span>
            
            
            <span class="tag">
                
                <a href="/tags/Android/" style="color: #03a9f4">
                    Android
                </a>
            </span>
            
        </span>
        
    </div>
    
    <div class="content" v-pre>
        <p> 在 Android 开发中，信息传递（数据传递）是组件间通信的核心，常见场景包括 Activity 之间、Activity 与 Fragment 之间、线程之间等。 </p>
<span id="more"></span>

<h3 id="一、Activity-之间的数据传递"><a href="#一、Activity-之间的数据传递" class="headerlink" title="一、Activity 之间的数据传递"></a>一、Activity 之间的数据传递</h3><p>最常用的是通过<code>Intent</code>携带数据，配合<code>startActivity()</code>或<code>startActivityForResult()</code>（已过时，推荐<code>Activity Result API</code>）。</p>
<h4 id="1-基础数据传递（Intent-putExtra-）"><a href="#1-基础数据传递（Intent-putExtra-）" class="headerlink" title="1. 基础数据传递（Intent.putExtra ()）"></a>1. 基础数据传递（Intent.putExtra ()）</h4><p><strong>发送方 Activity</strong>：</p>
<pre><code class="java">// 发送数据到目标Activity
Intent intent = new Intent(SenderActivity.this, ReceiverActivity.class);
// 传递基本类型数据
intent.putExtra(&quot;key_string&quot;, &quot;Hello Receiver&quot;);
intent.putExtra(&quot;key_int&quot;, 123);
intent.putExtra(&quot;key_boolean&quot;, true);
// 传递自定义对象（需实现Serializable或Parcelable）
User user = new User(&quot;Tom&quot;, 20);
intent.putExtra(&quot;key_user&quot;, user); // User需实现Serializable
startActivity(intent);
</code></pre>
<p><strong>接收方 Activity</strong>：</p>
<pre><code class="java">// 在onCreate中接收数据
@Override
protected void onCreate(Bundle savedInstanceState) &#123;
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_receiver);
    
    Intent intent = getIntent();
    // 获取基本类型数据
    String str = intent.getStringExtra(&quot;key_string&quot;);
    int num = intent.getIntExtra(&quot;key_int&quot;, 0); // 第二个参数为默认值
    boolean flag = intent.getBooleanExtra(&quot;key_boolean&quot;, false);
    
    // 获取自定义对象
    User user = (User) intent.getSerializableExtra(&quot;key_user&quot;);
&#125;

// 自定义对象（实现Serializable）
public class User implements Serializable &#123;
    private String name;
    private int age;
    
    // 构造方法、getter、setter
    public User(String name, int age) &#123;
        this.name = name;
        this.age = age;
    &#125;
    // ... getter和setter
&#125;
</code></pre>
<h4 id="2-回传数据（Activity-Result-API）"><a href="#2-回传数据（Activity-Result-API）" class="headerlink" title="2. 回传数据（Activity Result API）"></a>2. 回传数据（Activity Result API）</h4><p>替代已过时的<code>startActivityForResult()</code>，用于需要从目标 Activity 返回数据的场景。</p>
<p><strong>发送方 Activity</strong>：</p>
<pre><code class="java">import androidx.activity.result.ActivityResultLauncher;
import androidx.activity.result.contract.ActivityResultContracts;

public class SenderActivity extends AppCompatActivity &#123;
    // 注册回调
    private ActivityResultLauncher&lt;Intent&gt; resultLauncher = registerForActivityResult(
        new ActivityResultContracts.StartActivityForResult(),
        result -&gt; &#123;
            // 处理返回结果
            if (result.getResultCode() == RESULT_OK) &#123;
                Intent data = result.getData();
                if (data != null) &#123;
                    String returnStr = data.getStringExtra(&quot;return_key&quot;);
                    // 更新UI
                &#125;
            &#125;
        &#125;
    );

    // 触发跳转并等待返回
    public void sendAndWaitResult(View view) &#123;
        Intent intent = new Intent(this, ReceiverActivity.class);
        intent.putExtra(&quot;request_key&quot;, &quot;请处理数据&quot;);
        resultLauncher.launch(intent);
    &#125;
&#125;
</code></pre>
<p><strong>接收方 Activity</strong>：</p>
<pre><code class="java">// 处理数据并返回结果
public class ReceiverActivity extends AppCompatActivity &#123;
    @Override
    protected void onCreate(Bundle savedInstanceState) &#123;
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_receiver);
        
        // 获取请求数据
        String requestData = getIntent().getStringExtra(&quot;request_key&quot;);
        
        // 处理后返回结果
        findViewById(R.id.btn_return).setOnClickListener(v -&gt; &#123;
            Intent returnIntent = new Intent();
            returnIntent.putExtra(&quot;return_key&quot;, &quot;处理完成：&quot; + requestData);
            setResult(RESULT_OK, returnIntent);
            finish(); // 关闭当前Activity
        &#125;);
    &#125;
&#125;
</code></pre>
<h3 id="二、Activity-与-Fragment-之间的数据传递"><a href="#二、Activity-与-Fragment-之间的数据传递" class="headerlink" title="二、Activity 与 Fragment 之间的数据传递"></a>二、Activity 与 Fragment 之间的数据传递</h3><h4 id="1-Activity-向-Fragment-传递数据"><a href="#1-Activity-向-Fragment-传递数据" class="headerlink" title="1. Activity 向 Fragment 传递数据"></a>1. Activity 向 Fragment 传递数据</h4><p>通过<code>Fragment.setArguments(Bundle)</code>传递：</p>
<p><strong>Activity 中</strong>：</p>
<pre><code class="java">// 创建Fragment并传递数据
MyFragment fragment = new MyFragment();
Bundle bundle = new Bundle();
bundle.putString(&quot;fragment_key&quot;, &quot;来自Activity的数据&quot;);
bundle.putInt(&quot;fragment_num&quot;, 456);
fragment.setArguments(bundle);

// 加载Fragment
getSupportFragmentManager().beginTransaction()
    .replace(R.id.container, fragment)
    .commit();
</code></pre>
<p><strong>Fragment 中</strong>：</p>
<pre><code class="java">@Override
public void onCreate(Bundle savedInstanceState) &#123;
    super.onCreate(savedInstanceState);
    // 接收数据
    if (getArguments() != null) &#123;
        String str = getArguments().getString(&quot;fragment_key&quot;);
        int num = getArguments().getInt(&quot;fragment_num&quot;);
    &#125;
&#125;
</code></pre>
<h4 id="2-Fragment-向-Activity-传递数据"><a href="#2-Fragment-向-Activity-传递数据" class="headerlink" title="2. Fragment 向 Activity 传递数据"></a>2. Fragment 向 Activity 传递数据</h4><p>通过接口回调实现：</p>
<p><strong>定义回调接口（在 Fragment 中）</strong>：</p>
<pre><code class="java">public class MyFragment extends Fragment &#123;
    // 定义回调接口
    public interface OnDataPassListener &#123;
        void onDataPass(String data);
    &#125;
    
    private OnDataPassListener listener;
    
    // 绑定Activity时初始化接口
    @Override
    public void onAttach(@NonNull Context context) &#123;
        super.onAttach(context);
        if (context instanceof OnDataPassListener) &#123;
            listener = (OnDataPassListener) context;
        &#125; else &#123;
            throw new RuntimeException(&quot;Activity需实现OnDataPassListener接口&quot;);
        &#125;
    &#125;
    
    // 发送数据到Activity
    private void sendDataToActivity() &#123;
        String data = &quot;来自Fragment的数据&quot;;
        listener.onDataPass(data); // 调用接口方法
    &#125;
&#125;
</code></pre>
<p><strong>Activity 实现接口</strong>：</p>
<pre><code class="java">public class MainActivity extends AppCompatActivity implements MyFragment.OnDataPassListener &#123;
    @Override
    public void onDataPass(String data) &#123;
        // 接收Fragment传递的数据
        Log.d(&quot;MainActivity&quot;, &quot;收到数据：&quot; + data);
    &#125;
&#125;
</code></pre>
<h3 id="三、全局数据传递（Application-单例模式）"><a href="#三、全局数据传递（Application-单例模式）" class="headerlink" title="三、全局数据传递（Application &#x2F; 单例模式）"></a>三、全局数据传递（Application &#x2F; 单例模式）</h3><p>适合需要在整个应用中共享的数据（如用户信息、配置参数）。</p>
<h4 id="1-自定义-Application-类"><a href="#1-自定义-Application-类" class="headerlink" title="1. 自定义 Application 类"></a>1. 自定义 Application 类</h4><pre><code class="java">public class MyApplication extends Application &#123;
    private String globalData; // 全局共享数据
    
    public static MyApplication getInstance(Context context) &#123;
        return (MyApplication) context.getApplicationContext();
    &#125;
    
    // getter和setter
    public String getGlobalData() &#123;
        return globalData;
    &#125;
    
    public void setGlobalData(String data) &#123;
        this.globalData = data;
    &#125;
&#125;
</code></pre>
<p><strong>在 AndroidManifest.xml 中注册</strong>：</p>
<pre><code class="xml">&lt;application
    android:name=&quot;.MyApplication&quot;
    &lt;!-- 其他配置 --&gt;
&lt;/application&gt;
</code></pre>
<p><strong>使用方式</strong>：</p>
<pre><code class="java">// 保存数据
MyApplication.getInstance(this).setGlobalData(&quot;全局共享内容&quot;);

// 读取数据
String data = MyApplication.getInstance(this).getGlobalData();
</code></pre>
<h4 id="2-单例模式"><a href="#2-单例模式" class="headerlink" title="2. 单例模式"></a>2. 单例模式</h4><pre><code class="java">public class DataManager &#123;
    // 单例实例
    private static DataManager instance;
    private String sharedData;
    
    // 私有构造方法
    private DataManager() &#123;&#125;
    
    // 获取单例
    public static synchronized DataManager getInstance() &#123;
        if (instance == null) &#123;
            instance = new DataManager();
        &#125;
        return instance;
    &#125;
    
    // getter和setter
    public String getSharedData() &#123;
        return sharedData;
    &#125;
    
    public void setSharedData(String data) &#123;
        this.sharedData = data;
    &#125;
&#125;
</code></pre>
<p><strong>使用方式</strong>：</p>
<pre><code class="java">// 保存数据
DataManager.getInstance().setSharedData(&quot;单例共享数据&quot;);

// 读取数据
String data = DataManager.getInstance().getSharedData();
</code></pre>
<h3 id="四、线程间的数据传递"><a href="#四、线程间的数据传递" class="headerlink" title="四、线程间的数据传递"></a>四、线程间的数据传递</h3><p>子线程向主线程传递数据（更新 UI），主要通过<code>Handler</code>实现。</p>
<pre><code class="java">public class MainActivity extends AppCompatActivity &#123;
    private TextView textView;
    // 主线程的Handler
    private Handler mainHandler = new Handler(Looper.getMainLooper()) &#123;
        @Override
        public void handleMessage(@NonNull Message msg) &#123;
            super.handleMessage(msg);
            // 主线程中处理消息（更新UI）
            if (msg.what == 1) &#123;
                String result = (String) msg.obj;
                textView.setText(result);
            &#125;
        &#125;
    &#125;;

    @Override
    protected void onCreate(Bundle savedInstanceState) &#123;
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);
        textView = findViewById(R.id.text_view);
        
        // 启动子线程执行耗时操作
        new Thread(() -&gt; &#123;
            // 模拟耗时操作
            try &#123;
                Thread.sleep(2000);
            &#125; catch (InterruptedException e) &#123;
                e.printStackTrace();
            &#125;
            
            // 子线程发送数据到主线程
            Message message = Message.obtain();
            message.what = 1; // 消息标识
            message.obj = &quot;子线程处理完成的数据&quot;; // 传递的数据
            mainHandler.sendMessage(message);
        &#125;).start();
    &#125;
&#125;
</code></pre>
<h3 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h3><p>不同场景适合的传递方式：</p>
<ul>
<li><strong>组件间临时数据</strong>：优先使用<code>Intent</code> + <code>Bundle</code></li>
<li><strong>Activity 与 Fragment 通信</strong>：推荐接口回调或<code>ViewModel</code>（Jetpack 组件）</li>
<li><strong>全局共享数据</strong>：使用自定义<code>Application</code>或单例模式</li>
<li><strong>线程间通信</strong>：通过<code>Handler</code>或<code>runOnUiThread()</code></li>
</ul>

    </div>
    
    
    
    
    <div id="comment">
        <div id="giscus-container" class="giscus"></div>
    </div>
    
    
    
    
</div>

            <footer id="footer">
    <div id="footer-wrap">
        <div>
            &copy;
            2022 - 2025 NaoJianghh
            <span id="footer-icon">
                <i class="fa-solid fa-font-awesome fa-fw"></i>
            </span>
            &commat;脑浆糊
        </div>
        <div>
            Based on the <a target="_blank" rel="noopener" href="https://hexo.io">Hexo Engine</a> &amp;
            <a target="_blank" rel="noopener" href="https://github.com/theme-particlex/hexo-theme-particlex">ParticleX Theme</a>
        </div>
        
    </div>
</footer>

        </div>
        
        <transition name="fade">
            <div id="preview" ref="preview" v-show="previewShow">
                <img id="preview-content" ref="previewContent" />
            </div>
        </transition>
        
    </div>
    <script src="/js/main.js"></script>
    
    
<script
    src="https://giscus.app/client.js"
    data-repo="naojianghh/naojianghh.github.io"
    data-repo-id="R_kgDON0mDmw"
    data-category="Announcements"
    data-category-id="DIC_kwDON0mDm84CoLx1"
    data-mapping="url"
    data-strict="0"
    data-reactions-enabled="1"
    data-emit-metadata="0"
    data-input-position="bottom"
    data-theme="preferred_color_scheme"
    data-lang="zh-CN"
    crossorigin
    async
></script>





    
</body>
<canvas
    id="fireworks"
    style="position: fixed; top: 0; left: 0; width: 100vw; height: 100vh; pointer-events: none; z-index: 32767"
></canvas>
<script src="https://s4.zstatic.net/ajax/libs/animejs/3.2.1/anime.min.js"></script>
<script src="/js/fireworks.min.js"></script>

<canvas
    id="background"
    style="position: fixed; top: 0; left: 0; width: 100vw; height: 100vh; pointer-events: none; z-index: -1"
></canvas>
<script src="/js/background.min.js"></script>
</html>

