
<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="utf-8" />
    <title>页面展示与交互（进阶） | NaoJianghh</title>
    <meta name="author" content="脑浆糊" />
    <meta name="description" content="Welcome to My Blog" />
    <meta name="keywords" content="学习" />
    <meta
        name="viewport"
        content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0"
    />
    <link rel="icon" href="/images/avatar.jpg" />
    <link rel="preconnect" href="https://s4.zstatic.net" />
<script src="https://s4.zstatic.net/ajax/libs/vue/3.3.7/vue.global.prod.min.js"></script>
<link rel="stylesheet" href="https://s4.zstatic.net/ajax/libs/font-awesome/6.4.2/css/all.min.css" />
<link rel="preconnect" href="https://fonts.googleapis.cn" />
<link rel="preconnect" href="https://fonts.gstatic.cn" crossorigin />
<link
    rel="stylesheet"
    href="https://fonts.googleapis.cn/css2?family=Fira+Code:wght@400;500;600;700&family=Lexend:wght@400;500;600;700;800;900&family=Noto+Sans+SC:wght@400;500;600;700;800;900&display=swap"
/>
<script> const mixins = {}; </script>

<script src="https://polyfill.alicdn.com/v3/polyfill.min.js?features=default"></script>


<script src="https://s4.zstatic.net/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
<script src="https://s4.zstatic.net/ajax/libs/highlightjs-line-numbers.js/2.8.0/highlightjs-line-numbers.min.js"></script>
<link
    rel="stylesheet"
    href="https://s4.zstatic.net/ajax/libs/highlight.js/11.9.0/styles/github.min.css"
/>
<script src="/js/lib/highlight.js"></script>



<script src="/js/lib/preview.js"></script>









<link rel="stylesheet" href="/css/main.css" />

<meta name="generator" content="Hexo 7.3.0"><link rel="alternate" href="/atom.xml" title="NaoJianghh" type="application/atom+xml">
</head>
<body>
    <div id="layout">
        <transition name="fade">
            <div id="loading" v-show="loading">
                <div id="loading-circle">
                    <h2>LOADING</h2>
                    <p>加载过慢请开启缓存 浏览器默认开启</p>
                    <img src="/images/loading.gif" />
                </div>
            </div>
        </transition>
        <div id="menu" :class="{ hidden: hiddenMenu, 'menu-color': menuColor}">
    <nav id="desktop-menu">
        <a class="title" href="/">
            <span>NAOJIANGHH</span>
        </a>
        
        <a href="/">
            <i class="fa-solid fa-house fa-fw"></i>
            <span>&ensp;Home</span>
        </a>
        
        <a href="/about">
            <i class="fa-solid fa-id-card fa-fw"></i>
            <span>&ensp;About</span>
        </a>
        
        <a href="/archives">
            <i class="fa-solid fa-box-archive fa-fw"></i>
            <span>&ensp;Archives</span>
        </a>
        
        <a href="/categories">
            <i class="fa-solid fa-bookmark fa-fw"></i>
            <span>&ensp;Categories</span>
        </a>
        
        <a href="/tags">
            <i class="fa-solid fa-tags fa-fw"></i>
            <span>&ensp;Tags</span>
        </a>
        
    </nav>
    <nav id="mobile-menu">
        <div class="title" @click="showMenuItems = !showMenuItems">
            <i class="fa-solid fa-bars fa-fw"></i>
            <span>&emsp;NAOJIANGHH</span>
        </div>
        <transition name="slide">
            <div class="items" v-show="showMenuItems">
                
                <a href="/">
                    <div class="item">
                        <div style="min-width: 20px; max-width: 50px; width: 10%">
                            <i class="fa-solid fa-house fa-fw"></i>
                        </div>
                        <div style="min-width: 100px; max-width: 150%; width: 20%">Home</div>
                    </div>
                </a>
                
                <a href="/about">
                    <div class="item">
                        <div style="min-width: 20px; max-width: 50px; width: 10%">
                            <i class="fa-solid fa-id-card fa-fw"></i>
                        </div>
                        <div style="min-width: 100px; max-width: 150%; width: 20%">About</div>
                    </div>
                </a>
                
                <a href="/archives">
                    <div class="item">
                        <div style="min-width: 20px; max-width: 50px; width: 10%">
                            <i class="fa-solid fa-box-archive fa-fw"></i>
                        </div>
                        <div style="min-width: 100px; max-width: 150%; width: 20%">Archives</div>
                    </div>
                </a>
                
                <a href="/categories">
                    <div class="item">
                        <div style="min-width: 20px; max-width: 50px; width: 10%">
                            <i class="fa-solid fa-bookmark fa-fw"></i>
                        </div>
                        <div style="min-width: 100px; max-width: 150%; width: 20%">Categories</div>
                    </div>
                </a>
                
                <a href="/tags">
                    <div class="item">
                        <div style="min-width: 20px; max-width: 50px; width: 10%">
                            <i class="fa-solid fa-tags fa-fw"></i>
                        </div>
                        <div style="min-width: 100px; max-width: 150%; width: 20%">Tags</div>
                    </div>
                </a>
                
            </div>
        </transition>
    </nav>
</div>
<transition name="fade">
    <div id="menu-curtain" @click="showMenuItems = !showMenuItems" v-show="showMenuItems"></div>
</transition>

        <div id="main" :class="loading ? 'into-enter-from': 'into-enter-active'">
            <div class="article">
    <div>
        <h1>页面展示与交互（进阶）</h1>
    </div>
    <div class="info">
        <span class="date">
            <span class="icon">
                <i class="fa-solid fa-calendar fa-fw"></i>
            </span>
            2025/9/6
        </span>
        
        
        <span class="tags">
            <span class="icon">
                <i class="fa-solid fa-tags fa-fw"></i>
            </span>
            
            
            <span class="tag">
                
                <a href="/tags/Android/" style="color: #00bcd4">
                    Android
                </a>
            </span>
            
        </span>
        
    </div>
    
    <div class="content" v-pre>
        <p>复刻bilibiliUI项目学习<br>Github项目链接： <a target="_blank" rel="noopener" href="https://github.com/naojianghh/bilibili">naojianghh&#x2F;bilibili</a> </p>
<span id="more"></span>



<h1 id="仿哔哩哔哩哔哩项目收藏夹的展示与交互设计"><a href="#仿哔哩哔哩哔哩项目收藏夹的展示与交互设计" class="headerlink" title="仿哔哩哔哩哔哩项目收藏夹的展示与交互设计"></a>仿哔哩哔哩哔哩项目收藏夹的展示与交互设计</h1><p>收藏夹的展示与交互是仿哔哩哔哩项目中用户体验的重要组成部分，主要体现在收藏夹列表展示、收藏操作流程和收藏内容管理三个方面。以下从 UI 设计、交互逻辑和核心实现三个维度进行详细说明：</p>
<h2 id="一、收藏夹的层级展示设计"><a href="#一、收藏夹的层级展示设计" class="headerlink" title="一、收藏夹的层级展示设计"></a>一、收藏夹的层级展示设计</h2><h3 id="1-收藏夹列表页（MyFavoritesActivity）"><a href="#1-收藏夹列表页（MyFavoritesActivity）" class="headerlink" title="1. 收藏夹列表页（MyFavoritesActivity）"></a>1. 收藏夹列表页（MyFavoritesActivity）</h3><p>采用分组式列表展示结构，将收藏夹分为 “默认收藏夹” 和自定义收藏夹两类，通过 RecyclerView 实现多级级列表展示：</p>
<pre><code class="java">// 构建收藏夹与视频的映射关系
folderMap = new HashMap&lt;&gt;();
List&lt;FavoriteData&gt; defaultFolderFavorites = new ArrayList&lt;&gt;();
for (FavoriteData favorite : favorites) &#123;
    if (favorite.getFolderName().equals(DEFAULT_FOLDER_NAME)) &#123;
        defaultFolderFavorites.add(favorite);
    &#125;
&#125;
folderMap.put(DEFAULT_FOLDER_NAME, defaultFolderFavorites);
</code></pre>
<p>界面布局采用自定义 RecyclerView 适配器，通过多类型视图区分不同的展示元素：</p>
<ul>
<li>头部视图（TYPE_HEADER）：展示默认收藏夹</li>
<li>内容项（TYPE_ITEM）：展示收藏的视频缩略图</li>
<li>自定义收藏夹（TYPE_CREATED_FOLDERS）：展示用户创建的收藏夹</li>
</ul>
<h3 id="2-收藏夹详情页（FolderActivity）"><a href="#2-收藏夹详情页（FolderActivity）" class="headerlink" title="2. 收藏夹详情页（FolderActivity）"></a>2. 收藏夹详情页（FolderActivity）</h3><p>单收藏夹内容展示采用采用 “标题栏 + 功能区 + 视频列表” 的布局结构：</p>
<ul>
<li>顶部显示收藏夹名称和返回按钮</li>
<li>支持设置收藏夹封面图（相机拍摄或相册选择）</li>
<li>列表展示该收藏夹下所有视频，点击可跳转至视频播放页</li>
</ul>
<p>核心代码实现：</p>
<pre><code class="java">// 加载收藏夹封面图
String coverPath = databaseHelper.getFolderCover(folderName);
if (coverPath != null &amp;&amp; !coverPath.isEmpty()) &#123;
    setPicture.setVisibility(View.VISIBLE);
    // 区分封面类型：路径（相机图）/ Uri字符串（相册图）
    if (coverPath.startsWith(&quot;/&quot;)) &#123;
        // 相机图：通过路径加载图片（压缩避免OOM）
        Bitmap compressedBitmap = decodeCompressedBitmap(coverPath, 80, 80);
        setPicture.setImageBitmap(compressedBitmap);
    &#125; else if (coverPath.startsWith(&quot;content://&quot;)) &#123;
        // 相册图：通过Uri加载
        Uri coverUri = Uri.parse(coverPath.split(&quot;\\|&quot;)[0]);
        setPicture.setImageURI(coverUri);
    &#125;
&#125;
</code></pre>
<h2 id="二、核心交互流程"><a href="#二、核心交互流程" class="headerlink" title="二、核心交互流程"></a>二、核心交互流程</h2><h3 id="1-视频收藏操作流程"><a href="#1-视频收藏操作流程" class="headerlink" title="1. 视频收藏操作流程"></a>1. 视频收藏操作流程</h3><p><strong>触发入口</strong>：视频详情页的收藏按钮（item_video_function.xml 中的 collect ImageView）</p>
<p><strong>交互流程</strong>：</p>
<ol>
<li>点击收藏按钮，弹出底部夹弹窗（FavoriteDialogFragment）</li>
<li>弹窗展示现有有收藏夹列表，支持创建新收藏夹</li>
<li>选择目标收藏夹后，通过数据库 DatabaseHelper 将视频添加到对应收藏夹</li>
<li>收藏成功后实时新 UI 状态，更新收藏按钮样式</li>
</ol>
<p>弹窗交互核心代码：</p>
<pre><code class="java">saveFavoriteButton.setOnClickListener(v -&gt; &#123;
    FavoriteDialogDialogFragment dialog = new FavoriteDialogFragment(currentVideoData);
    dialog.show(getSupportFragmentManager(), &quot;favorite_dialog&quot;);
    // 监听收藏结果
    getSupportFragmentManager().setFragmentResultListener(&quot;request_key&quot;, this, 
        (requestKey, result) -&gt; &#123;
            String folderName = result.getString(&quot;selected_folder_name&quot;);
            if (folderName != null) &#123;
                // 更新UI显示收藏状态
                updateFavoriteButtonState(true);
            &#125;
        &#125;);
&#125;);
</code></pre>
<h3 id="2-收藏夹管理交互"><a href="#2-收藏夹管理交互" class="headerlink" title="2. 收藏夹管理交互"></a>2. 收藏夹管理交互</h3><p><strong>创建收藏夹</strong>：</p>
<ul>
<li>通过 MyFavoritesActivity 中的 “创建收藏夹” 按钮触发</li>
<li>跳转至 CreateFolderActivity 输入收藏夹名称</li>
<li>创建成功后自动新收藏夹列表</li>
</ul>
<p><strong>删除收藏夹</strong>：</p>
<ul>
<li>长按收藏夹或点击更多按钮弹出删除确认</li>
<li>通过 FolderMoreDialogFragment 实现删除确认交互</li>
<li>删除时同步删除该收藏夹下所有视频</li>
</ul>
<pre><code class="java">folderMoreDialogFragment.setListener(new FolderMoreDialogFragment.OnDeleteButtonClickListener() &#123;
    @Override
    public void onDeleteButtonClick() &#123;
        databaseHelperHelper.deleteFolder(folderName);
        updateFavoriteList(); // 刷新列表
        folderMoreDialogFragment.dismiss();
    &#125;
&#125;);
</code></pre>
<p><strong>收藏夹封面设置</strong>：</p>
<ul>
<li>支持从相机拍摄或相册选择图片作为封面</li>
<li>通过图片压缩处理避免 OOM：</li>
</ul>
<pre><code class="java">private Bitmap private decodeCompressedBitmap(String imagePath, int reqWidthDp, int reqHeightDp) &#123;
    int reqWidth = dp2px(reqWidthDp);
    int reqHeight = dp2px(reqHeightDp);
    
    // 先获取图片原始尺寸（不加载完整图片）
    BitmapFactory.Options options = new BitmapFactory.Options();
    options.inJustDecodeBounds = true;
    BitmapFactory.decodeFile(imagePath, options);
    
    // 计算压缩比例
    options.inSampleSize = calculateInSampleSize(options, reqWidth, reqHeight);
    
    // 加载压缩后的图片
    options.inJustDecodeBounds = false;
    return BitmapFactoryFactory.decodeFile(imagePath, options);
&#125;
</code></pre>
<h2 id="三、UI-组件与交互细节"><a href="#三、UI-组件与交互细节" class="headerlink" title="三、UI 组件与交互细节"></a>三、UI 组件与交互细节</h2><h3 id="1-底部弹窗（FavoriteDialogFragment）"><a href="#1-底部弹窗（FavoriteDialogFragment）" class="headerlink" title="1. 底部弹窗（FavoriteDialogFragment）"></a>1. 底部弹窗（FavoriteDialogFragment）</h3><p>采用 BottomSheetDialogFragment 实现，支持：</p>
<ul>
<li>上下滑动关闭</li>
<li>收藏夹列表选择</li>
<li>新建收藏夹创建入口</li>
</ul>
<p>滑动关闭实现：</p>
<pre><code class="java">View dragHandle = view.findViewById(R.id.drag_handle);
dragHandle.setOnTouchListener(new SwipeDismissTouchListener(dragHandle, null, 
    new SwipeDismissTouchListener.OnDismissCallback() &#123;
        @Override
        public void onDismiss(View view) &#123;
            dismiss();
        &#125;
    &#125;));
</code></pre>
<h3 id="2-收藏状态视觉反馈"><a href="#2-收藏状态视觉反馈" class="headerlink" title="2. 收藏状态视觉反馈"></a>2. 收藏状态视觉反馈</h3><ul>
<li>未收藏状态：显示灰色收藏图标</li>
<li>已收藏状态：显示红色填充图标</li>
<li>收藏数量实时更新（item_video_function.xml 中的 collect_text）</li>
</ul>
<h3 id="3-空状态处理"><a href="#3-空状态处理" class="headerlink" title="3. 空状态处理"></a>3. 空状态处理</h3><p>当收藏夹为空时，通过 FavoritesAdapter 控制列表展示：</p>
<pre><code class="java">@Override
public int getItemCount() &#123;
    if (favorites.size() == 0) &#123;
        return 0; // 不显示任何内容或显示空状态提示
    &#125; else &#123;
        return favorites.size() + 1; // +1 用于显示功能区
    &#125;
&#125;
</code></pre>
<h2 id="四、数据流转与状态同步"><a href="#四、数据流转与状态同步" class="headerlink" title="四、数据流转与状态同步"></a>四、数据流转与状态同步</h2><ol>
<li><strong>收藏状态同步</strong>：<ul>
<li>视频详情页通过<code>isFavoriteExists()</code>方法检查收藏状态</li>
<li>收藏 &#x2F; 取消收藏操作后通过接口回调更新 UI</li>
</ul>
</li>
<li><strong>列表刷新机制</strong>：<ul>
<li>所有收藏操作后调用<code>updateFavoriteList()</code>刷新列表</li>
<li>使用<code>notifyDataSetChanged()</code>更新适配器数据</li>
</ul>
</li>
<li><strong>跨页面数据传递</strong>：<ul>
<li>通过 Intent 传递收藏夹名称和视频 ID</li>
<li>使用 ActivityResultLauncher 处理封面设置等交互结果</li>
</ul>
</li>
</ol>

    </div>
    
    
    
    
    <div id="comment">
        <div id="giscus-container" class="giscus"></div>
    </div>
    
    
    
    
</div>

            <footer id="footer">
    <div id="footer-wrap">
        <div>
            &copy;
            2022 - 2025 NaoJianghh
            <span id="footer-icon">
                <i class="fa-solid fa-font-awesome fa-fw"></i>
            </span>
            &commat;脑浆糊
        </div>
        <div>
            Based on the <a target="_blank" rel="noopener" href="https://hexo.io">Hexo Engine</a> &amp;
            <a target="_blank" rel="noopener" href="https://github.com/theme-particlex/hexo-theme-particlex">ParticleX Theme</a>
        </div>
        
    </div>
</footer>

        </div>
        
        <transition name="fade">
            <div id="preview" ref="preview" v-show="previewShow">
                <img id="preview-content" ref="previewContent" />
            </div>
        </transition>
        
    </div>
    <script src="/js/main.js"></script>
    
    
<script
    src="https://giscus.app/client.js"
    data-repo="naojianghh/naojianghh.github.io"
    data-repo-id="R_kgDON0mDmw"
    data-category="Announcements"
    data-category-id="DIC_kwDON0mDm84CoLx1"
    data-mapping="url"
    data-strict="0"
    data-reactions-enabled="1"
    data-emit-metadata="0"
    data-input-position="bottom"
    data-theme="preferred_color_scheme"
    data-lang="zh-CN"
    crossorigin
    async
></script>





    
</body>
<canvas
    id="fireworks"
    style="position: fixed; top: 0; left: 0; width: 100vw; height: 100vh; pointer-events: none; z-index: 32767"
></canvas>
<script src="https://s4.zstatic.net/ajax/libs/animejs/3.2.1/anime.min.js"></script>
<script src="/js/fireworks.min.js"></script>

<canvas
    id="background"
    style="position: fixed; top: 0; left: 0; width: 100vw; height: 100vh; pointer-events: none; z-index: -1"
></canvas>
<script src="/js/background.min.js"></script>
</html>

